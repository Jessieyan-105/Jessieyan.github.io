<!DOCTYPE html>
<html lang="en">

<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
    <title>
      
        MUSIC SIGNAL ANALYSIS |
          
            Jessie Yan&#39;s blog
    </title>
    <!-- 主css -->
    <link rel="stylesheet" href="/sass/main.css">
      <!-- seo -->
      <meta name="description" content="12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989910010110210">
<meta property="og:type" content="article">
<meta property="og:title" content="MUSIC SIGNAL ANALYSIS">
<meta property="og:url" content="http://yoursite.com/2019/09/12/Project-Summary/index.html">
<meta property="og:site_name" content="Jessie Yan&#39;s blog">
<meta property="og:description" content="12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989910010110210">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-09-12T06:11:48.634Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MUSIC SIGNAL ANALYSIS">
<meta name="twitter:description" content="12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697989910010110210">
        <!-- facicon -->
        
          <link rel="icon" href="http://7xp1k3.com1.z0.glb.clouddn.com/octocat-de-los-muertos.jpg">
          
            <!-- 统计 -->
            
              <script>
                var _hmt = _hmt || [];
                (function () {
                  var hm = document.createElement("script");
                  hm.src = "//hm.baidu.com/hm.js?c21994907883f37ffd80e13627dd4faa";
                  var s = document.getElementsByTagName("script")[0];
                  s.parentNode.insertBefore(hm, s);
                })();
              </script>
              
                
                    <script src="http://cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>
</head></html>
	<body>
		<div class="main">
			<div id="mobile-bar">
    <a class="menu-button"></a>
    <a class="logo" href="/">Jessie Yan</a>
</div>
<header class="nav-header">
    <a href="/" class="logo-link">Jessie Yan</a>
    
            
    <ul class="nav nav-list">
        <li class="nav-list-item"><a href="/">Home</a></li>
        
            
        
    </ul>
</header>
<div class="sidebar">
    
            
    <ul class="main-menu">
        <li class="main-menu-item"><a href="/">Home</a></li>
        
            
        
    </ul>
</div>

<h1 class="blog-title">The Jessie Yan Blog</h1>

			
<article class="article-main" itemscope itemprop="blogPost">
        <div class="articleCon">
            <header class="article-header">
                <h1 itemprop="name">
                    <a href="/2019/09/12/Project-Summary/" class="article-title">MUSIC SIGNAL ANALYSIS</a>
                </h1>
            </header>
            
<div class="bookmark" id="bookmark">
    
</div>

            
            <div class="article-meta">
                <div class="article-dateTime">
    <a href="/2019/09/12/Project-Summary/" class="article-date">
        <time datetime="Sep 12th 2019" itemprop="datePublished">
            Sep 12th 2019
        </time>
    </a>
</div>

            </div>
            <div class="article-inner">
                <div class="article-entry" itemprop="articleBody">
                    <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy, scipy, matplotlib.pyplot <span class="keyword">as</span> plt, pandas, librosa,sklearn,IPython.display <span class="keyword">as</span> ipd</span><br><span class="line"><span class="keyword">import</span> matplotlib.style <span class="keyword">as</span> ms</span><br><span class="line">ms.use(<span class="string">'seaborn-muted'</span>)</span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line">get_ipython().run_line_magic(<span class="string">'matplotlib'</span>, <span class="string">'inline'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[2]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">float_formatter = <span class="keyword">lambda</span> x: <span class="string">"%.4f"</span> % x</span><br><span class="line">numpy.set_printoptions(formatter=&#123;<span class="string">'float_kind'</span>:float_formatter&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># #### HOW HUMANS RECOGNIZE MUSIC ?</span></span><br><span class="line"><span class="comment"># * Vibration of air molecules (Sound Waves)</span></span><br><span class="line"><span class="comment"># * Capturing sounds waves with external ear</span></span><br><span class="line"><span class="comment"># * Sending waves to middle air</span></span><br><span class="line"><span class="comment"># * Converting sound waves into sound signals </span></span><br><span class="line"><span class="comment"># * Sending signals through auditory nerves to brain</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[4]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ipd.Image(filename=<span class="string">'./Resources/kulak.jpg'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># #### HOW TO CONVERT ANALOG SIGNALS TO DIGITAL SIGNALS</span></span><br><span class="line"><span class="comment"># * An analog signal is a continuous wave denoted by a sine wave (pictured below) and may vary in signal strength (amplitude) or frequency (time).</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># * A digital signal - a must for computer processing - is described as using binary (0s and 1s), and therefore, cannot take on any fractional values.</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># * We do quantization to get digital signals from analog signals. Digital computers can only capture this data at discrete moments in time. The rate at which a computer captures audio data is called the sampling rate.</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># * For example if we use 44.1 KHz sampling rate, it means that we use 44100 samples per second.</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># * **_Information:_** Humans can hear the sounds between 0-140 dB and 20-20000 Hz !</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[5]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ipd.Image(filename=<span class="string">'./Resources/low.jpg'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[6]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ipd.Image(filename=<span class="string">'./Resources/high.jpg'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * Let's take two songs from GTZAN dataset as arrays of samples.</span></span><br><span class="line"><span class="comment"># * Sampling rate is 22050 Hz.</span></span><br><span class="line"><span class="comment"># * We take 5 seconds slices from songs.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[9]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sampling_rate=<span class="number">22050</span></span><br><span class="line"></span><br><span class="line">x_metal,sr=librosa.load(<span class="string">"./Resources/metal.00001.wav"</span>,sr=sampling_rate,mono=<span class="literal">True</span>,duration=<span class="number">5.0</span>)</span><br><span class="line">x_classical,sr=librosa.load(<span class="string">"./Resources/classical.00001.wav"</span>,sr=sampling_rate,mono=<span class="literal">True</span>,duration=<span class="number">5.0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[10]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">"Overview of the array of samples for Metal song:(size=&#123;&#125;)\n&#123;&#125;:\n "</span>.format(x_metal.shape,x_metal))</span><br><span class="line">print(<span class="string">"Overview of the array of samples for Classical song:(size=&#123;&#125;)\n&#123;&#125;"</span>.format(x_classical.shape,x_classical))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * We got 110250 samples with 22.05 KHz sampling rate.</span></span><br><span class="line"><span class="comment"># * We got an array of samples for each song</span></span><br><span class="line"><span class="comment"># * Every member of the array is a sample from signal.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># * Let's plot the waveplots for each song.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[11]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#Waveplot - Time Domain</span></span><br><span class="line"></span><br><span class="line">fig=plt.figure(figsize=(<span class="number">12</span>,<span class="number">5</span>))</span><br><span class="line">fig.subplots_adjust(hspace=<span class="number">.5</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">plt.xlabel(<span class="string">"Time"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"Amplitude"</span>)</span><br><span class="line">librosa.display.waveplot(x_metal,sampling_rate)</span><br><span class="line">plt.title(<span class="string">'Metal'</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line">plt.ylim(<span class="number">-0.4</span>,<span class="number">0.4</span>)</span><br><span class="line">plt.xlabel(<span class="string">"Time"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"Amplitude"</span>)</span><br><span class="line">librosa.display.waveplot(x_classical,sampling_rate)</span><br><span class="line">plt.title(<span class="string">'Clasical'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * Let's play the songs.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[12]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ipd.Audio(x_metal, rate=sampling_rate)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[14]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ipd.Audio(x_classical, rate=sampling_rate)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * We can see some differences between two waveplots.</span></span><br><span class="line"><span class="comment"># * With waveplots, we only have Amplitude and time information.</span></span><br><span class="line"><span class="comment"># * We can't learn so much from only waveplots.</span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"><span class="comment"># **_SOLUTION ?_**</span></span><br><span class="line"><span class="comment">#  - Fourier Tranform ( We wil see it in this notebook).</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># * **It's not a good way to analyze a complete song in time.**</span></span><br><span class="line"><span class="comment"># * In audio processing, it is common to operate on one frame at a time using a constant frame size and hop size. Frames are typically chosen to be 10 to 100 ms in duration.</span></span><br><span class="line"><span class="comment"># * We compute features from frames.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># * **_Some Terms:_**</span></span><br><span class="line"><span class="comment">#  - Frame Length: The number of samples in a frame.</span></span><br><span class="line"><span class="comment">#  - Hop Length: The length between frames. (in samples)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># * We use 2048 frame length and 512 hop length for this work.</span></span><br><span class="line"><span class="comment"># * Also these values are the deafults for Librosa.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[15]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hop_size=<span class="number">512</span></span><br><span class="line">frame_size=<span class="number">2048</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[16]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#Segmentation</span></span><br><span class="line">F=librosa.util.frame(x_metal,frame_length=frame_size,hop_length=hop_size)</span><br><span class="line">x,y=F.shape</span><br><span class="line"></span><br><span class="line">print(<span class="string">"Number of frames=&#123;&#125; with frame size=&#123;&#125; for Metal song"</span>.format(y,x))</span><br><span class="line">print(<span class="string">"Total number of samples= &#123;&#125;\n"</span>.format(y*x+hop_size))</span><br><span class="line">print(F)</span><br><span class="line"></span><br><span class="line">F2=librosa.util.frame(x_classical,frame_length=frame_size,hop_length=hop_size)</span><br><span class="line">x2,y2=F2.shape</span><br><span class="line"></span><br><span class="line">print(<span class="string">"\nNumber of frames=&#123;&#125; with frame size=&#123;&#125; for Classical song"</span>.format(y2,x2))</span><br><span class="line">print(<span class="string">"Total number of samples= &#123;&#125;\n"</span>.format(y2*x2+hop_size))</span><br><span class="line">print(F2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * How can we do a segmentation in other way ?</span></span><br><span class="line"><span class="comment"># * If we can find the most valuable points in a signal and do segmentation after that points we can have valuable information with less frames.</span></span><br><span class="line"><span class="comment"># ** ONSET DETECTION **</span></span><br><span class="line"><span class="comment"># * Automatic detection of musical events in an audio signal is one of the most fundamental tasks in music information retrieval. Here, we will show how to detect an onset, the very instant that marks the beginning of the transient part of a sound, or the earliest moment at which a transient can be reliably detected.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[17]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#Onset Detection</span></span><br><span class="line">onset_frames = librosa.onset.onset_detect(x_metal, sr=sampling_rate,hop_length=hop_size)</span><br><span class="line">onset_times = librosa.frames_to_time(onset_frames)</span><br><span class="line">x=onset_frames.size</span><br><span class="line">print(<span class="string">"Number of detected onsets for Metal song=&#123;&#125;"</span>.format(x))</span><br><span class="line">print(onset_frames)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">onset_frames2 = librosa.onset.onset_detect(x_classical, sr=sampling_rate,hop_length=hop_size)</span><br><span class="line">onset_times2 = librosa.frames_to_time(onset_frames2)</span><br><span class="line">x2=onset_frames2.size</span><br><span class="line">print(<span class="string">"\nNumber of detected onsets for Classical song=&#123;&#125;"</span>.format(x2))</span><br><span class="line">print(onset_frames2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * Let plot waveplot with detected onsets.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[18]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fig=plt.figure(figsize=(<span class="number">12</span>,<span class="number">5</span>))</span><br><span class="line">fig.subplots_adjust(hspace=<span class="number">.5</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">librosa.display.waveplot(x_metal, sr=sampling_rate)</span><br><span class="line">plt.vlines(onset_times*<span class="number">1000</span>, <span class="number">-0.8</span>, <span class="number">0.79</span>, color=<span class="string">'r'</span>, alpha=<span class="number">0.8</span>)</span><br><span class="line">plt.xlabel(<span class="string">"Time (s)"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"Amplitude"</span>)</span><br><span class="line">plt.title(<span class="string">'Metal'</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">librosa.display.waveplot(x_classical, sr=sampling_rate)</span><br><span class="line">plt.vlines(onset_times2*<span class="number">1000</span>, <span class="number">-0.8</span>, <span class="number">0.79</span>, color=<span class="string">'r'</span>, alpha=<span class="number">0.8</span>)</span><br><span class="line">plt.xlabel(<span class="string">"Time (s)"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"Amplitude"</span>)</span><br><span class="line">plt.title(<span class="string">'Classical'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * Let's create a click sound and add this sound to each onset on signal</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[21]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">clicks = librosa.clicks(frames=onset_frames, sr=sampling_rate, length=len(x_metal))</span><br><span class="line">ipd.Audio(x_metal + clicks, rate=sampling_rate)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[20]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">clicks = librosa.clicks(frames=onset_frames2, sr=sampling_rate, length=len(x_classical))</span><br><span class="line">ipd.Audio(x_classical + clicks, rate=sampling_rate)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * **Fourier Transform**</span></span><br><span class="line"><span class="comment"># * The Fourier Transform is one of the most fundamental operations in applied mathematics and signal processing.</span></span><br><span class="line"><span class="comment"># * It transforms our time-domain signal into the frequency domain. Whereas the time domain expresses our signal as a sequence of samples, the frequency domain expresses our signal as a superposition of sinusoids of varying magnitudes, frequencies, and phase offsets.</span></span><br><span class="line"><span class="comment">#  </span></span><br><span class="line"><span class="comment"># </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[22]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ipd.Image(filename=<span class="string">'./Resources/time_and_freq.jpg'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[23]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ipd.display(ipd.Image(url=<span class="string">'https://upload.wikimedia.org/wikipedia/commons/7/72/Fourier_transform_time_and_frequency_domains_%28small%29.gif'</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * Let's compute FFTs for each song and plot Spectrums.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[24]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Fourier Transform and Spectrum</span></span><br><span class="line"></span><br><span class="line">fig=plt.figure(figsize=(<span class="number">12</span>,<span class="number">5</span>))</span><br><span class="line">fig.subplots_adjust(hspace=<span class="number">.5</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">FFT_Metal=scipy.fft(x_metal)</span><br><span class="line">FFT_Metal_Mag=numpy.absolute(FFT_Metal)</span><br><span class="line">plt.xlabel(<span class="string">"Frequency (Hz)"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"Amplitude"</span>)</span><br><span class="line">plt.title(<span class="string">'Metal'</span>)</span><br><span class="line">plt.plot(FFT_Metal_Mag)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">FFT_Classical=scipy.fft(x_classical)</span><br><span class="line">FFT_Classical_Mag=numpy.absolute(FFT_Classical)</span><br><span class="line">plt.xlabel(<span class="string">"Frequency (Hz)"</span>)</span><br><span class="line">plt.ylabel(<span class="string">"Amplitude"</span>)</span><br><span class="line">plt.title(<span class="string">'Classical'</span>)</span><br><span class="line">plt.plot(FFT_Classical_Mag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * We have frequency information of signals.</span></span><br><span class="line"><span class="comment"># * But we lost information about time.</span></span><br><span class="line"><span class="comment"># * How can we get information about time and frequency at the same time ?</span></span><br><span class="line"><span class="comment"># * **Short-Time Fourier Transform**</span></span><br><span class="line"><span class="comment">#  - Musical signals are highly non-stationary, i.e., their statistics change over time. It would be rather meaningless to compute a spectrum over an entire 10-minute song.</span></span><br><span class="line"><span class="comment">#  - With STFT, we break up the signal into dicsrete windows.</span></span><br><span class="line"><span class="comment">#  - We use a window fucntion such as Polynomial, Hanning, Hamming...</span></span><br><span class="line"><span class="comment">#  - Each signal within a window is a stationary signal.</span></span><br><span class="line"><span class="comment">#  - After we apply FFT over each window we obtain Spectogram of the signal.</span></span><br><span class="line"><span class="comment">#  - **_Window Size_:** Number of samples in each window.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Let's compute STFSs for each song and plot Spectograms.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[25]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#Short-Time Fourier Transform and Spectogram</span></span><br><span class="line"></span><br><span class="line">window_size=<span class="number">2048</span></span><br><span class="line"></span><br><span class="line">fig=plt.figure(figsize=(<span class="number">12</span>,<span class="number">5</span>))</span><br><span class="line">fig.subplots_adjust(hspace=<span class="number">.5</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">S = librosa.feature.melspectrogram(x_metal, sr=sampling_rate, n_fft=window_size)</span><br><span class="line">logS = librosa.logamplitude(S)</span><br><span class="line">plt.title(<span class="string">'Metal'</span>)</span><br><span class="line">librosa.display.specshow(logS, sr=sampling_rate, x_axis=<span class="string">'time'</span>, y_axis=<span class="string">'mel'</span>)</span><br><span class="line">plt.colorbar(format=<span class="string">'%+2.0f dB'</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">S2 = librosa.feature.melspectrogram(x_classical, sr=sampling_rate, n_fft=window_size)</span><br><span class="line">logS2 = librosa.logamplitude(S2)</span><br><span class="line">plt.title(<span class="string">'Classical'</span>)</span><br><span class="line">librosa.display.specshow(logS2, sr=sampling_rate, x_axis=<span class="string">'time'</span>, y_axis=<span class="string">'mel'</span>)</span><br><span class="line">plt.colorbar(format=<span class="string">'%+2.0f dB'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * Let's add the onsets that we detected before to Spectograms.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[26]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">fig=plt.figure(figsize=(<span class="number">12</span>,<span class="number">5</span>))</span><br><span class="line">fig.subplots_adjust(hspace=<span class="number">.5</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">S = librosa.feature.melspectrogram(x_metal, sr=sampling_rate, n_fft=window_size)</span><br><span class="line">logS = librosa.logamplitude(S)</span><br><span class="line">plt.title(<span class="string">'Metal'</span>)</span><br><span class="line">librosa.display.specshow(logS, sr=sampling_rate, x_axis=<span class="string">'time'</span>, y_axis=<span class="string">'log'</span>)</span><br><span class="line">plt.vlines(onset_frames, <span class="number">0</span>, logS.shape[<span class="number">0</span>], color=<span class="string">'k'</span>, alpha=<span class="number">0.8</span>)</span><br><span class="line">plt.colorbar(format=<span class="string">'%+2.0f dB'</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">S2 = librosa.feature.melspectrogram(x_classical, sr=sampling_rate, n_fft=window_size)</span><br><span class="line">logS2 = librosa.logamplitude(S2)</span><br><span class="line">plt.title(<span class="string">'Classical'</span>)</span><br><span class="line">librosa.display.specshow(logS2, sr=sampling_rate, x_axis=<span class="string">'time'</span>, y_axis=<span class="string">'log'</span>)</span><br><span class="line">plt.vlines(onset_frames2, <span class="number">0</span>, logS.shape[<span class="number">0</span>], color=<span class="string">'k'</span>, alpha=<span class="number">0.8</span>)</span><br><span class="line">plt.colorbar(format=<span class="string">'%+2.0f dB'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * **Constant-Q Transform**</span></span><br><span class="line"><span class="comment">#  - If we want to obtain information about pitch values we use Constant-Q Transform.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Let's apply Constant-Q Transform and obtain Chromagram for each song.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[27]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#Canstant-Q Transform and Chromagram</span></span><br><span class="line"></span><br><span class="line">fig=plt.figure(figsize=(<span class="number">12</span>,<span class="number">5</span>))</span><br><span class="line">fig.subplots_adjust(hspace=<span class="number">.5</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">C = librosa.cqt(x_metal, sr=sampling_rate,hop_length=hop_size,real=<span class="literal">False</span>,fmin=librosa.note_to_hz(<span class="string">'C2'</span>))</span><br><span class="line">logC = librosa.logamplitude(C)</span><br><span class="line">plt.title(<span class="string">'Metal'</span>)</span><br><span class="line">librosa.display.specshow(logC, sr=sampling_rate, x_axis=<span class="string">'time'</span>, y_axis=<span class="string">'cqt_note'</span>,cmap=<span class="string">'coolwarm'</span>,)</span><br><span class="line">plt.colorbar(format=<span class="string">'%+2.0f dB'</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">C2 = librosa.cqt(x_classical, sr=sampling_rate,hop_length=hop_size,real=<span class="literal">False</span>,fmin=librosa.note_to_hz(<span class="string">'C2'</span>))</span><br><span class="line">logC2 = librosa.logamplitude(C2)</span><br><span class="line">plt.title(<span class="string">'Classical'</span>)</span><br><span class="line">librosa.display.specshow(logC2, sr=sampling_rate, x_axis=<span class="string">'time'</span>, y_axis=<span class="string">'cqt_note'</span>,cmap=<span class="string">'coolwarm'</span>)</span><br><span class="line">plt.colorbar(format=<span class="string">'%+2.0f dB'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># * Let's do the same thing with pitch classes.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In[28]:</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#Canstant-Q Transform and Chromagram with Pitch Classes</span></span><br><span class="line"></span><br><span class="line">fig=plt.figure(figsize=(<span class="number">12</span>,<span class="number">5</span>))</span><br><span class="line">fig.subplots_adjust(hspace=<span class="number">.5</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">C = librosa.feature.chroma_cqt(x_metal, sr=sampling_rate,hop_length=hop_size,fmin=librosa.note_to_hz(<span class="string">'C2'</span>))</span><br><span class="line">plt.title(<span class="string">'Metal'</span>)</span><br><span class="line">librosa.display.specshow(C, sr=sampling_rate, x_axis=<span class="string">'time'</span>, y_axis=<span class="string">'chroma'</span>,cmap=<span class="string">'coolwarm'</span>)</span><br><span class="line">plt.colorbar(format=<span class="string">'%+2.0f dB'</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>)</span><br><span class="line">C2 = librosa.feature.chroma_cqt(x_classical, sr=sampling_rate,fmin=librosa.note_to_hz(<span class="string">'C2'</span>))</span><br><span class="line">plt.title(<span class="string">'Classical'</span>)</span><br><span class="line">librosa.display.specshow(C2, sr=sampling_rate, x_axis=<span class="string">'time'</span>, y_axis=<span class="string">'chroma'</span>,cmap=<span class="string">'coolwarm'</span>)</span><br><span class="line">plt.colorbar(format=<span class="string">'%+2.0f dB'</span>)</span><br></pre></td></tr></table></figure>


                </div>
                
<nav id="article-nav">
  
    <a href="/2019/09/12/PS2/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title">
        
          Genre Classification Tutorial >
        
      </div>
    </a>
  
  
</nav>


            </div>
        </div>
        
            <div id="disqus_thread"></div>
<script>
    (function() { // DON'T EDIT BELOW THIS LINE
        var d = document,
            s = d.createElement('script');

        s.src = '//yzzting.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
<script id="dsq-count-scr" src="//yzzting.disqus.com/count.js" async></script>

        
        
</article>



		</div>
		<div id="heart"></div>

    <footer class="blog-footer" id="blog-footer">
        <div id="footer-info" class="inner">
            Made with ♥ by <a href="https://github.com/yzzting/hexo-theme-MyFairLady" target="_blank">MyFairLady</a>
        </div>
    </footer>
    <script src="/js/sidebar.js"></script>
    <script src="/js/toTop.js"></script>
    <script src="/js/bookmark.js"></script>
	</body>
	</html>
